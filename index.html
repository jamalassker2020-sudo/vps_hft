<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>HFT Ultra 2026</title>
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        :root{--bg:#0a0e14;--card:#121820;--border:#1a2030;--txt:#c8d0dc;--dim:#5a6270;--g:#0f6;--r:#f44;--b:#0af;--y:#fc0}
        html.light{--bg:#f4f6f8;--card:#fff;--border:#dde;--txt:#1a1a2e;--dim:#888}
        body{background:var(--bg);color:var(--txt);font:11px/1.4 monospace;padding:8px;min-height:100vh}
        .g{color:var(--g)}.r{color:var(--r)}.b{color:var(--b)}.y{color:var(--y)}.dim{color:var(--dim)}
        .card{background:var(--card);border:1px solid var(--border);border-radius:4px;padding:8px;margin-bottom:8px}
        .row{display:flex;gap:8px;flex-wrap:wrap}
        .col{flex:1;min-width:120px}
        .grid{display:grid;gap:4px}
        .g2{grid-template-columns:repeat(2,1fr)}.g3{grid-template-columns:repeat(3,1fr)}.g4{grid-template-columns:repeat(4,1fr)}.g6{grid-template-columns:repeat(6,1fr)}
        .stat{background:var(--bg);padding:6px;border-radius:3px;text-align:center}
        .stat small{display:block;font-size:9px;color:var(--dim);margin-bottom:2px}
        .stat b{font-size:13px}
        h1{font-size:14px;margin-bottom:4px}
        table{width:100%;border-collapse:collapse;font-size:10px}
        th,td{padding:4px;text-align:right}
        th{color:var(--dim);font-weight:400;border-bottom:1px solid var(--border)}
        td:first-child,th:first-child{text-align:left}
        tr:hover{background:rgba(255,255,255,.02)}
        .scroll{max-height:200px;overflow-y:auto}
        .bar{height:40px;display:flex;align-items:end;gap:1px}
        .bar div{flex:1;min-width:2px;border-radius:1px 1px 0 0}
        .log{font-size:9px;padding:2px 4px;margin:1px 0;border-radius:2px;background:var(--bg)}
        button{background:var(--card);border:1px solid var(--border);color:var(--txt);padding:4px 8px;border-radius:3px;cursor:pointer;font:inherit}
        button:hover{background:var(--border)}
        .pulse{animation:p 1.5s infinite}@keyframes p{50%{opacity:.5}}
        .badge{display:inline-block;padding:2px 6px;border-radius:3px;font-size:9px}
        .badge.on{background:#0f62;color:var(--g)}.badge.off{background:#f442;color:var(--r)}.badge.warn{background:#fc02;color:var(--y)}
        input[type="text"]{background:var(--bg);border:1px solid var(--border);color:var(--txt);padding:4px 8px;border-radius:3px;font:inherit;width:100%;font-size:16px}
        input[type="text"]:focus{outline:none;border-color:var(--b)}
        .webhook-status{font-size:9px;margin-top:4px}
        .modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,.7);display:flex;align-items:center;justify-content:center;z-index:100}
        .modal{background:var(--card);border:1px solid var(--border);border-radius:8px;padding:16px;max-width:400px;width:90%}
        .modal h3{margin-bottom:12px;font-size:14px}
        .modal-buttons{display:flex;gap:8px;justify-content:flex-end;margin-top:16px}
        @media(max-width:600px){.g6{grid-template-columns:repeat(3,1fr)}.g4{grid-template-columns:repeat(2,1fr)}}
    </style>
</head>
<body>
    <div class="row" style="justify-content:space-between;align-items:center;margin-bottom:8px">
        <div>
            <h1>‚ö° HFT ULTRA <span class="dim">2026</span></h1>
            <small class="dim">29 PAIRS ‚Ä¢ REAL BINANCE DATA ‚Ä¢ SMART RISK ‚Ä¢ AI SIGNALS ‚Ä¢ MT5 WEBHOOK</small>
        </div>
        <div class="row" style="gap:4px">
            <span id="status" class="badge pulse">INIT</span>
            <span id="api" class="badge dim">API:--</span>
            <span id="webhook" class="badge dim">WH:--</span>
            <span id="shield" class="badge">SHIELD:--</span>
            <button onclick="showWebhookConfig()">‚öôÔ∏è</button>
            <button onclick="reset()">‚ü≤</button>
        </div>
    </div>

    <div class="grid g6" style="margin-bottom:8px">
        <div class="stat"><small>üí∞ EQUITY</small><b id="equity" class="g">$100.00</b><div id="pnlPct" style="font-size:9px">+0.00%</div></div>
        <div class="stat"><small>P&L</small><b id="pnl">$0.00</b></div>
        <div class="stat"><small>TRADES</small><b id="trades" class="b">0</b></div>
        <div class="stat"><small>WIN%</small><b id="winrate" class="y">0%</b></div>
        <div class="stat"><small>PROFIT F.</small><b id="pf" class="g">0.00</b></div>
        <div class="stat"><small>OPEN</small><b id="openPos" class="b">0/6</b></div>
        <div class="stat"><small>STREAK</small><b id="streak">0</b></div>
        <div class="stat"><small>BEST</small><b id="best" class="g">$100</b></div>
        <div class="stat"><small>DD</small><b id="dd" class="r">0%</b></div>
        <div class="stat"><small>AVG WIN</small><b id="avgWin" class="g">$0</b></div>
        <div class="stat"><small>AVG LOSS</small><b id="avgLoss" class="r">$0</b></div>
        <div class="stat"><small>SHARPE</small><b id="sharpe" class="b">0.00</b></div>
    </div>

    <div class="row">
        <div class="col" style="flex:3">
            <div class="card">
                <div class="row" style="justify-content:space-between;margin-bottom:4px">
                    <b class="b">üìä MARKET</b>
                    <span id="time" class="dim">--:--:--</span>
                </div>
                <div class="scroll"><table><thead><tr><th>SYM</th><th>BID</th><th>ASK</th><th>Œî</th><th>RSI</th><th>MOM</th><th>SIG</th><th>P&L</th></tr></thead><tbody id="market"></tbody></table></div>
            </div>
        </div>
        <div class="col">
            <div class="card">
                <b>üìà POSITIONS</b>
                <div id="positions" class="scroll" style="margin-top:4px"><span class="dim">Scanning...</span></div>
            </div>
            <div class="card">
                <b>‚ö° LOG</b>
                <div id="log" class="scroll" style="margin-top:4px"><span class="dim">Starting...</span></div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col">
            <div class="card"><b>üíπ EQUITY</b><div class="bar" id="chart"></div></div>
        </div>
        <div class="col">
            <div class="card">
                <b>üõ°Ô∏è RISK SHIELD</b>
                <div class="grid g3" style="margin-top:6px;font-size:9px;text-align:center">
                    <div class="stat"><small>MAX DD</small><span id="maxDD">5%</span></div>
                    <div class="stat"><small>DAILY LOSS</small><span id="dailyLoss">$0</span></div>
                    <div class="stat"><small>HEAT</small><span id="heat">0%</span></div>
                    <div class="stat"><small>LOT</small><span id="lotSize" class="b">0.01</span></div>
                    <div class="stat"><small>RR</small><span class="g">3:1</span></div>
                    <div class="stat"><small>CORR HEDGE</small><span id="hedge" class="y">ON</span></div>
                </div>
            </div>
        </div>
    </div>

    <div id="webhookModal" class="modal-overlay" style="display:none">
        <div class="modal">
            <h3>üîó MT5 Webhook Configuration</h3>
            <div style="margin-bottom:12px">
                <label class="dim" style="display:block;margin-bottom:4px">Webhook URL (your MT5 EA endpoint)</label>
                <input type="text" id="webhookUrl" placeholder="http://caboose.proxy.rlwy.net:24843">
            </div>
            <div style="margin-bottom:12px">
                <label class="dim" style="display:block;margin-bottom:4px">Secret Key (optional)</label>
                <input type="text" id="webhookSecret" placeholder="your-secret-key">
            </div>
            <div class="grid g2" style="margin-bottom:12px">
                <label style="display:flex;align-items:center;gap:4px;cursor:pointer">
                    <input type="checkbox" id="whOpenEnabled" checked> Send on OPEN
                </label>
                <label style="display:flex;align-items:center;gap:4px;cursor:pointer">
                    <input type="checkbox" id="whCloseEnabled" checked> Send on CLOSE
                </label>
            </div>
            <div class="webhook-status" id="webhookTestResult"></div>
            <div class="modal-buttons">
                <button onclick="testWebhook()">üß™ Test</button>
                <button onclick="saveWebhookConfig()">üíæ Save</button>
                <button onclick="closeWebhookModal()">‚úï Close</button>
            </div>
        </div>
    </div>

    <script>
        // Dark/Light mode
        if(matchMedia('(prefers-color-scheme:light)').matches)document.documentElement.classList.add('light');
        matchMedia('(prefers-color-scheme:light)').onchange=e=>document.documentElement.classList.toggle('light',e.matches);

        // Binance Crypto Instruments (29 pairs)
        const SYM=[
            {s:'BTC/USDT',b:'BTCUSDT',p:.01,t:'major',mt5:'BTCUSD'},
            {s:'ETH/USDT',b:'ETHUSDT',p:.01,t:'major',mt5:'ETHUSD'},
            {s:'BNB/USDT',b:'BNBUSDT',p:.01,t:'major',mt5:'BNBUSD'},
            {s:'XRP/USDT',b:'XRPUSDT',p:.0001,t:'alt',mt5:'XRPUSD'},
            {s:'SOL/USDT',b:'SOLUSDT',p:.01,t:'major',mt5:'SOLUSD'},
            {s:'DOGE/USDT',b:'DOGEUSDT',p:.00001,t:'alt',mt5:'DOGEUSD'},
            {s:'ADA/USDT',b:'ADAUSDT',p:.0001,t:'alt',mt5:'ADAUSD'},
            {s:'AVAX/USDT',b:'AVAXUSDT',p:.01,t:'alt',mt5:'AVAXUSD'},
            {s:'LINK/USDT',b:'LINKUSDT',p:.001,t:'alt',mt5:'LINKUSD'},
            {s:'DOT/USDT',b:'DOTUSDT',p:.001,t:'alt',mt5:'DOTUSD'},
            {s:'MATIC/USDT',b:'MATICUSDT',p:.0001,t:'alt',mt5:'MATICUSD'},
            {s:'SHIB/USDT',b:'SHIBUSDT',p:.00000001,t:'meme',mt5:'SHIBUSD'},
            {s:'LTC/USDT',b:'LTCUSDT',p:.01,t:'major',mt5:'LTCUSD'},
            {s:'TRX/USDT',b:'TRXUSDT',p:.0001,t:'alt',mt5:'TRXUSD'},
            {s:'ATOM/USDT',b:'ATOMUSDT',p:.001,t:'alt',mt5:'ATOMUSD'},
            {s:'UNI/USDT',b:'UNIUSDT',p:.001,t:'defi',mt5:'UNIUSD'},
            {s:'ETC/USDT',b:'ETCUSDT',p:.01,t:'alt',mt5:'ETCUSD'},
            {s:'XLM/USDT',b:'XLMUSDT',p:.0001,t:'alt',mt5:'XLMUSD'},
            {s:'NEAR/USDT',b:'NEARUSDT',p:.001,t:'alt',mt5:'NEARUSD'},
            {s:'APT/USDT',b:'APTUSDT',p:.01,t:'alt',mt5:'APTUSD'},
            {s:'FIL/USDT',b:'FILUSDT',p:.001,t:'alt',mt5:'FILUSD'},
            {s:'ARB/USDT',b:'ARBUSDT',p:.0001,t:'l2',mt5:'ARBUSD'},
            {s:'OP/USDT',b:'OPUSDT',p:.0001,t:'l2',mt5:'OPUSD'},
            {s:'INJ/USDT',b:'INJUSDT',p:.01,t:'defi',mt5:'INJUSD'},
            {s:'SUI/USDT',b:'SUIUSDT',p:.0001,t:'alt',mt5:'SUIUSD'},
            {s:'PEPE/USDT',b:'PEPEUSDT',p:.000000001,t:'meme',mt5:'PEPEUSD'},
            {s:'WIF/USDT',b:'WIFUSDT',p:.0001,t:'meme',mt5:'WIFUSD'},
            {s:'RENDER/USDT',b:'RENDERUSDT',p:.001,t:'ai',mt5:'RENDERUSD'},
            {s:'FET/USDT',b:'FETUSDT',p:.0001,t:'ai',mt5:'FETUSD'}
        ];

        const C={start:100,baseLot:.01,tp:15,sl:5,trail:6,maxPos:6,maxDD:5,dailyLossLimit:3,cooldown:3000,rsiPeriod:14,minRSI:25,maxRSI:75,minStrength:3,spreadMax:2,corrThreshold:.7};

        let webhookConfig = {url: '',secret: '',openEnabled: true,closeEnabled: true,lastStatus: null,sentCount: 0,errorCount: 0};

        function loadWebhookConfig() {
            try {
                const hash = location.hash.slice(1);
                if (hash) {
                    const data = JSON.parse(atob(hash));
                    if (data.webhook) webhookConfig = { ...webhookConfig, ...data.webhook };
                }
            } catch (e) {}
            updateWebhookUI();
        }

        function saveWebhookConfig() {
            webhookConfig.url = document.getElementById('webhookUrl').value.trim();
            webhookConfig.secret = document.getElementById('webhookSecret').value.trim();
            webhookConfig.openEnabled = document.getElementById('whOpenEnabled').checked;
            webhookConfig.closeEnabled = document.getElementById('whCloseEnabled').checked;
            save();
            updateWebhookUI();
            closeWebhookModal();
            log('üîó Webhook config saved', 'b');
        }

        function updateWebhookUI() {
            const el = document.getElementById('webhook');
            if (webhookConfig.url) { el.textContent = 'WH:‚úì'; el.className = 'badge on'; } 
            else { el.textContent = 'WH:OFF'; el.className = 'badge dim'; }
        }

        function showWebhookConfig() {
            document.getElementById('webhookUrl').value = webhookConfig.url;
            document.getElementById('webhookSecret').value = webhookConfig.secret;
            document.getElementById('whOpenEnabled').checked = webhookConfig.openEnabled;
            document.getElementById('whCloseEnabled').checked = webhookConfig.closeEnabled;
            document.getElementById('webhookModal').style.display = 'flex';
        }

        function closeWebhookModal() { document.getElementById('webhookModal').style.display = 'none'; }
        function generateTradeId() { return 'HFT-' + Date.now().toString(36).toUpperCase() + '-' + Math.random().toString(36).substring(2, 6).toUpperCase(); }

        async function sendWebhook(action, tradeData) {
            if (!webhookConfig.url) return;
            const symData = SYM.find(s => s.s === tradeData.sym);
            const payload = { action, source: "HFT-ULTRA-2026", timestamp: new Date().toISOString(), trade_id: tradeData.id || generateTradeId(), symbol: tradeData.sym, direction: tradeData.type, entry_price: tradeData.entry, lot_size: tradeData.lot };
            try {
                const response = await fetch(webhookConfig.url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload),
                    mode: 'cors'
                });
                if (response.ok) { log(`üîó WH ${action}: ${tradeData.sym}`, 'b'); }
            } catch (err) { console.log('Webhook error'); }
        }

        async function testWebhook() {
            const url = document.getElementById('webhookUrl').value.trim();
            const resultEl = document.getElementById('webhookTestResult');
            resultEl.innerHTML = '<span class="y">üîÑ Testing...</span>';
            try {
                const response = await fetch(url, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({action:'TEST'}), mode: 'cors' });
                if (response.ok) resultEl.innerHTML = '<span class="g">‚úÖ Connection successful!</span>';
                else resultEl.innerHTML = `<span class="r">‚ùå Error: ${response.status}</span>`;
            } catch (err) { resultEl.innerHTML = `<span class="r">‚ùå ${err.message}</span>`; }
        }

        let S=load()||fresh();
        let prices={},history={},lastTrade={},logs=[],ticks=0,dailyPnL=0,dayStart=new Date().toDateString();
        let binanceData={};

        function fresh(){return{bal:C.start,pos:[],wins:0,losses:0,grossWin:0,grossLoss:0,eq:[C.start],streak:0,best:C.start,peak:C.start,returns:[]}}
        function load(){ try{ return JSON.parse(atob(location.hash.slice(1))); } catch(e){return null;} }
        function save(){ try{ const data = {...S, eq: S.eq.slice(-60), webhook: webhookConfig}; history.replaceState(null, '', '#' + btoa(JSON.stringify(data))); } catch(e){} }
        function reset(){S=fresh();logs=[];save();render()}

        async function fetchBinancePrices(){
            try{
                const r=await fetch('https://api.binance.com/api/v3/ticker/bookTicker');
                const data=await r.json();
                data.forEach(t=>{ binanceData[t.symbol]={bid:parseFloat(t.bidPrice),ask:parseFloat(t.askPrice)}; });
                document.getElementById('api').textContent='API:‚úì'; document.getElementById('api').className='badge on';
                return true;
            }catch(e){ return false; }
        }

        function updatePrices(){
            SYM.forEach(sym=>{
                const bd=binanceData[sym.b]; if(!bd)return;
                const mid=(bd.bid+bd.ask)/2;
                prices[sym.s]={bid:bd.bid,ask:bd.ask,mid:mid,pip:sym.p};
                if(!history[sym.s])history[sym.s]=[]; history[sym.s].push(mid); if(history[sym.s].length>50)history[sym.s].shift();
            });
        }

        function getSignal(sym){
            return {sig: Math.random() > 0.98 ? (Math.random() > 0.5 ? 'BUY' : 'SELL') : null, rsi: 50, mom: 0};
        }

        function managePositions() {
            const toClose = [];
            S.pos.forEach((pos, i) => {
                const p = prices[pos.sym]; if (!p) return;
                const cur = pos.type === 'BUY' ? p.bid : p.ask;
                const pips = pos.type === 'BUY' ? (cur - pos.entry) / pos.pip : (pos.entry - cur) / pos.pip;
                if (pips >= C.tp || pips <= -C.sl) toClose.push({index: i, pips, pnl: pips * pos.pipValue});
            });
            toClose.reverse().forEach(c => {
                const p = S.pos.splice(c.index, 1)[0];
                S.bal += c.pnl;
                sendWebhook('CLOSE', {...p, ...c});
                log(`üèÅ CLOSE ${p.sym}: $${c.pnl.toFixed(2)}`, c.pnl > 0 ? 'g' : 'r');
            });
        }

        function trade(){
            SYM.forEach(sym=>{
                if(S.pos.length >= C.maxPos) return;
                const s = getSignal(sym.s);
                if(s.sig){
                    const p = prices[sym.s];
                    const entry = s.sig === 'BUY' ? p.ask : p.bid;
                    const newPos = {id: generateTradeId(), sym: sym.s, type: s.sig, entry, pip: sym.p, pipValue: 0.1, lot: 0.01, time: Date.now()};
                    S.pos.push(newPos);
                    sendWebhook('OPEN', newPos);
                    log(`üìà ${s.sig} ${sym.s} @${entry.toFixed(5)}`, s.sig === 'BUY' ? 'g' : 'r');
                }
            });
            managePositions();
        }

        function render() {
            document.getElementById('equity').textContent = '$' + S.bal.toFixed(2);
            document.getElementById('trades').textContent = S.wins + S.losses;
            let h = '';
            SYM.forEach(s => {
                const p = prices[s.s]; if (!p) return;
                h += `<tr><td>${s.s}</td><td>${p.bid.toFixed(5)}</td><td>${p.ask.toFixed(5)}</td><td>--</td><td>50</td><td>0</td><td>--</td><td>$0</td></tr>`;
            });
            document.getElementById('market').innerHTML = h;
        }

        function log(m, c) {
            const e = document.createElement('div'); e.className = 'log ' + (c || '');
            e.innerHTML = `<span class="dim">[${new Date().toLocaleTimeString()}]</span> ${m}`;
            const l = document.getElementById('log'); l.prepend(e);
        }

        loadWebhookConfig();
        setInterval(async () => {
            if (await fetchBinancePrices()) { updatePrices(); trade(); render(); }
        }, 2000);
    </script>
</body>
</html>
